0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP DATABASE IF EXISTS team1_projectdb CASCADE;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE DATABASE team1_projectdb LOCATION "project/hive/warehouse";
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team1_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE police_dept_incident_reports STORED AS AVRO LOCATION 'project/warehouse/police_dept_incident_re ports' TBLPROPERTIES ('avro.schema.url'='project/warehouse/avsc/police_dept_incident_reports.avsc');
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM police_dept_incident_reports LIMIT 10;
+-------------------------------------------------+---------------------------------------------+---------------------------------------------+---------------------------------------------+--------------------------------------------+-----------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------------------------------+------------------------------------------+------------------------------------------------+----------------------------------------------------+---------------------------------------------+---------------------------------------------+-------------------------------------------------+----------------------------------------------------+----------------------------------------------------+------------------------------------------+--------------------------------------------+-----------------------------------+-----------------------------------------------+----------------------------------------------+------------------------------------------------+----------------------------------------------------+----------------------------------------+-----------------------------------------+-------------------------------------------------+----------------------------------------------+--------------------------------------+------------------------------------------+------------------------------------+------------------------------------+-----------------------------------+-----------------------------------+-----------------------------------+
| police_dept_incident_reports.incident_datetime  | police_dept_incident_reports.incident_date  | police_dept_incident_reports.incident_time  | police_dept_incident_reports.incident_year  | police_dept_incident_reports.incident_dow  | police_dept_incident_reports.report_datetime  | police_dept_incident_reports.row_id  | police_dept_incident_reports.incident_id  | police_dept_incident_reports.incident_number  | police_dept_incident_reports.cad_number  | police_dept_incident_reports.report_type_code  | police_dept_incident_reports.report_type_description | police_dept_incident_reports.filled_online  | police_dept_incident_reports.incident_code  | police_dept_incident_reports.incident_category  | police_dept_incident_reports.incident_subcategory  |    police_dept_incident_reports.incident_descr     | police_dept_incident_reports.resolution  | police_dept_incident_reports.intersection  | police_dept_incident_reports.cnn  | police_dept_incident_reports.police_district  | police_dept_incident_reports.analysis_neigh  | police_dept_incident_reports.supervisor_distr  | police_dept_incident_reports.supervisor_distr_2012 | police_dept_incident_reports.latitude  | police_dept_incident_reports.longitude  |     police_dept_incident_reports.datapoint      | police_dept_incident_reports.neighbourhoods  | police_dept_incident_reports.esncag  | police_dept_incident_reports.cm_polygon  | police_dept_incident_reports.cchr  | police_dept_incident_reports.hsoc  | police_dept_incident_reports.iin  | police_dept_incident_reports.csd  | police_dept_incident_reports.cpd  |
+-------------------------------------------------+---------------------------------------------+---------------------------------------------+---------------------------------------------+--------------------------------------------+-----------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------------------------------+------------------------------------------+------------------------------------------------+----------------------------------------------------+---------------------------------------------+---------------------------------------------+-------------------------------------------------+----------------------------------------------------+----------------------------------------------------+------------------------------------------+--------------------------------------------+-----------------------------------+-----------------------------------------------+----------------------------------------------+------------------------------------------------+----------------------------------------------------+----------------------------------------+-----------------------------------------+-------------------------------------------------+----------------------------------------------+--------------------------------------+------------------------------------------+------------------------------------+------------------------------------+-----------------------------------+-----------------------------------+-----------------------------------+
| 1686776400000                                   | 1686776400000                               | 02:00                                       | 2023                                        | Thursday                                   | 1687726800000                                 | 134227306374                         | 1342273                                   | 236120498                                     | NULL                                     | II                                             | Coplogic Initial                                   | true                                        | 6374                                        | Larceny Theft                                   | Larceny Theft - Other                              | Theft, Other Property, >$950                       | Open or Active                           | FELL ST \ LAGUNA ST                        | 25913000                          | Northern                                      | Hayes Valley                                 | 5                                              | 5                                                  | 37.77552454478846                      | -122.42607032528431                     | POINT (-122.42607032528431 37.77552454478846)   | 22                                           | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 11                                | 4                                 |
| 1686776400000                                   | 1686776400000                               | 14:00                                       | 2023                                        | Thursday                                   | 1686949200000                                 | 134232006374                         | 1342320                                   | 236122961                                     | NULL                                     | II                                             | Coplogic Initial                                   | true                                        | 6374                                        | Larceny Theft                                   | Larceny Theft - Other                              | Theft, Other Property, >$950                       | Open or Active                           | GREEN ST \ SANSOME ST                      | 24822000                          | Central                                       | North Beach                                  | 3                                              | 3                                                  | 37.80030712878617                      | -122.40260412542855                     | POINT (-122.40260412542857 37.80030712878617)   | NULL                                         | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 3                                 | 6                                 |
| 1686776400000                                   | 1686776400000                               | 14:00                                       | 2023                                        | Thursday                                   | 1689022800000                                 | 129494107021                         | 1294941                                   | 230479845                                     | 231921150                                | VI                                             | Vehicle Initial                                    | NULL                                        | 7021                                        | Motor Vehicle Theft                             | Motor Vehicle Theft                                | Vehicle, Stolen, Auto                              | Open or Active                           | BERTHA LN \ HUDSON AVE                     | 20087000                          | Bayview                                       | Bayview Hunters Point                        | 10                                             | 10                                                 | 37.73242217387174                      | -122.38018459028908                     | POINT (-122.38018459028908 37.73242217387174)   | 86                                           | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 9                                 | 2                                 |
| 1686776400000                                   | 1686776400000                               | 14:00                                       | 2023                                        | Thursday                                   | 1686862800000                                 | 128659771013                         | 1286597                                   | 230415350                                     | 231672104                                | VI                                             | Vehicle Initial                                    | NULL                                        | 71013                                       | Larceny Theft                                   | Theft From Vehicle                                 | License Plate, Stolen                              | Open or Active                           | DUBOCE AVE \ DIVISADERO ST                 | 26010000                          | Park                                          | Castro/Upper Market                          | 8                                              | 8                                                  | 37.76900080136138                      | -122.43658826795966                     | POINT (-122.43658826795966 37.76900080136138)   | 112                                          | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 5                                 | 7                                 |
| 1686776400000                                   | 1686776400000                               | 14:00                                       | 2023                                        | Thursday                                   | 1687381200000                                 | 128852205041                         | 1288522                                   | 230429458                                     | 231730724                                | II                                             | Initial                                            | NULL                                        | 5041                                        | Burglary                                        | Burglary - Residential                             | Burglary, Residence, Forcible Entry                | Open or Active                           | 30TH ST \ CHURCH ST                        | 21876000                          | Ingleside                                     | Noe Valley                                   | 8                                              | 8                                                  | 37.74207802838362                      | -122.42684637612442                     | POINT (-122.42684637612442 37.742078028383624)  | 59                                           | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 5                                 | 9                                 |
| 1686776400000                                   | 1686776400000                               | 14:00                                       | 2023                                        | Thursday                                   | 1686862800000                                 | 128657306234                         | 1286573                                   | 230415059                                     | 231671543                                | II                                             | Initial                                            | NULL                                        | 6234                                        | Larceny Theft                                   | Larceny - Auto Parts                               | Theft, Vehicle Strip, >$950                        | Open or Active                           | JAMESTOWN AVE \ JENNINGS ST                | 20459000                          | Bayview                                       | Bayview Hunters Point                        | 10                                             | 10                                                 | 37.71955810405571                      | -122.39543147525843                     | POINT (-122.39543147525845 37.71955810405571)   | 88                                           | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 9                                 | 2                                 |
| 1686776400000                                   | 1686776400000                               | 14:00                                       | 2023                                        | Thursday                                   | 1686776400000                                 | 128612606243                         | 1286126                                   | 230413188                                     | 231662588                                | II                                             | Initial                                            | NULL                                        | 6243                                        | Larceny Theft                                   | Larceny - From Vehicle                             | Theft, From Locked Vehicle, $200-$950              | Open or Active                           | WASHINGTON ST \ DRUMM ST                   | 24571000                          | Central                                       | Financial District/South Beach               | 3                                              | 3                                                  | 37.796346859010335                     | -122.39695784020824                     | POINT (-122.39695784020824 37.796346859010335)  | 77                                           | NULL                                 | NULL                                     | NULL                               | 4                                  | NULL                              | 3                                 | 6                                 |
| 1686776400000                                   | 1686776400000                               | 14:05                                       | 2023                                        | Thursday                                   | 1686862800000                                 | 128715506244                         | 1287155                                   | 236109765                                     | NULL                                     | II                                             | Coplogic Initial                                   | true                                        | 6244                                        | Larceny Theft                                   | Larceny - From Vehicle                             | Theft, From Locked Vehicle, >$950                  | Open or Active                           | FULTON ST \ GOUGH ST                       | 25940000                          | Northern                                      | Hayes Valley                                 | 5                                              | 5                                                  | 37.77874737106934                      | -122.42335402580974                     | POINT (-122.42335402580974 37.77874737106934)   | 97                                           | NULL                                 | NULL                                     | 1                                  | 1                                  | NULL                              | 11                                | 4                                 |
| 1686776400000                                   | 1686776400000                               | 14:07                                       | 2023                                        | Thursday                                   | 1687122000000                                 | 134188406374                         | 1341884                                   | 236119407                                     | NULL                                     | II                                             | Coplogic Initial                                   | true                                        | 6374                                        | Larceny Theft                                   | Larceny Theft - Other                              | Theft, Other Property, >$950                       | Open or Active                           | WILLOW ST \ FRANKLIN ST                    | 25188000                          | Northern                                      | Western Addition                             | 2                                              | 5                                                  | 37.78315142705044                      | -122.4225579822023                      | POINT (-122.4225579822023 37.78315142705044)    | 100                                          | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 11                                | 4                                 |
| 1686776400000                                   | 1686776400000                               | 14:10                                       | 2023                                        | Thursday                                   | 1686776400000                                 | 128611306154                         | 1286113                                   | 230412851                                     | 231662057                                | II                                             | Initial                                            | NULL                                        | 6154                                        | Larceny Theft                                   | Larceny Theft - Other                              | Theft, From Person, >$950 (other than Pickpocket)  | Open or Active                           | TARAVAL ST \ 19TH AVE                      | 23183000                          | Taraval                                       | Sunset/Parkside                              | 7                                              | 4                                                  | 37.743051811670966                     | -122.47564446909298                     | POINT (-122.47564446909298 37.743051811670966)  | NULL                                         | NULL                                 | NULL                                     | NULL                               | NULL                               | NULL                              | 7                                 | 10                                |
+-------------------------------------------------+---------------------------------------------+---------------------------------------------+---------------------------------------------+--------------------------------------------+-----------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------------------------------+------------------------------------------+------------------------------------------------+----------------------------------------------------+---------------------------------------------+---------------------------------------------+-------------------------------------------------+----------------------------------------------------+----------------------------------------------------+------------------------------------------+--------------------------------------------+-----------------------------------+-----------------------------------------------+----------------------------------------------+------------------------------------------------+----------------------------------------------------+----------------------------------------+-----------------------------------------+-------------------------------------------------+----------------------------------------------+--------------------------------------+------------------------------------------+------------------------------------+------------------------------------+-----------------------------------+-----------------------------------+-----------------------------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.exec.dynamic.partition = true;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.exec.dynamic.partition.mode = nonstrict;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.enforce.bucketing=true;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE TABLE IF NOT EXISTS police_dept_incident_reports_part_buck (
. . . . . . . . . . . . . . . . . . . . . . .>     incident_datetime date,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_date date,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_time char(5),
. . . . . . . . . . . . . . . . . . . . . . .>     incident_dow VARCHAR(10),
. . . . . . . . . . . . . . . . . . . . . . .>     report_datetime date,
. . . . . . . . . . . . . . . . . . . . . . .>     row_id bigint,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_id integer,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_number integer,
. . . . . . . . . . . . . . . . . . . . . . .>     cad_number integer,
. . . . . . . . . . . . . . . . . . . . . . .>     report_type_code char(2),
. . . . . . . . . . . . . . . . . . . . . . .>     report_type_description VARCHAR(19),
. . . . . . . . . . . . . . . . . . . . . . .>     filled_online BOOLEAN,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_code integer,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_category VARCHAR(50),
. . . . . . . . . . . . . . . . . . . . . . .>     incident_subcategory VARCHAR(40),
. . . . . . . . . . . . . . . . . . . . . . .>     incident_descr VARCHAR(90),
. . . . . . . . . . . . . . . . . . . . . . .>     resolution VARCHAR(20),
. . . . . . . . . . . . . . . . . . . . . . .>     intersection VARCHAR(90),
. . . . . . . . . . . . . . . . . . . . . . .>     cnn integer,
. . . . . . . . . . . . . . . . . . . . . . .>     police_district VARCHAR(10),
. . . . . . . . . . . . . . . . . . . . . . .>     analysis_neigh VARCHAR(30),
. . . . . . . . . . . . . . . . . . . . . . .>     supervisor_distr integer,
. . . . . . . . . . . . . . . . . . . . . . .>     supervisor_distr_2012 integer,
. . . . . . . . . . . . . . . . . . . . . . .>     latitude float,
. . . . . . . . . . . . . . . . . . . . . . .>     longitude float,
. . . . . . . . . . . . . . . . . . . . . . .>     datapoint VARCHAR(46),
. . . . . . . . . . . . . . . . . . . . . . .>     neighbourhoods integer,
. . . . . . . . . . . . . . . . . . . . . . .>     -- ESNCAG - Boundary File
. . . . . . . . . . . . . . . . . . . . . . .>     esncag integer,
. . . . . . . . . . . . . . . . . . . . . . .>     -- Central Market/Tenderloin Boundary Polygon - Updated
. . . . . . . . . . . . . . . . . . . . . . .>     cm_polygon integer,
. . . . . . . . . . . . . . . . . . . . . . .>     -- Civic Center Harm Reduction Project Boundary
. . . . . . . . . . . . . . . . . . . . . . .>     cchr integer,
. . . . . . . . . . . . . . . . . . . . . . .>     -- HSOC Zones as of 2018-06-05
. . . . . . . . . . . . . . . . . . . . . . .>     hsoc integer,
. . . . . . . . . . . . . . . . . . . . . . .>     -- Invest In Neighborhoods (IIN) Areas
. . . . . . . . . . . . . . . . . . . . . . .>     iin integer,
. . . . . . . . . . . . . . . . . . . . . . .>     -- Current Supervisor Districts
. . . . . . . . . . . . . . . . . . . . . . .>     csd integer,
. . . . . . . . . . . . . . . . . . . . . . .>     -- Current Police Districts
. . . . . . . . . . . . . . . . . . . . . . .>     cpd integer
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .>     PARTITIONED BY (incident_year integer) 
. . . . . . . . . . . . . . . . . . . . . . .>     CLUSTERED BY (row_id) into 7 buckets
. . . . . . . . . . . . . . . . . . . . . . .>     STORED AS AVRO LOCATION 'project/hive/warehouse/police_dept_incident_reports' 
. . . . . . . . . . . . . . . . . . . . . . .>     TBLPROPERTIES ('AVRO.COMPRESS'='SNAPPY')
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO police_dept_incident_reports_part_buck
. . . . . . . . . . . . . . . . . . . . . . .> SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>     from_unixtime(FLOOR(CAST(incident_datetime AS BIGINT)/1000), 'yyyy-MM-dd HH:mm:ss.SSS') AS incident_datetime,
. . . . . . . . . . . . . . . . . . . . . . .>     from_unixtime(FLOOR(CAST(incident_date AS BIGINT)/1000), 'yyyy-MM-dd HH:mm:ss.SSS') AS incident_date,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_time,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_dow,
. . . . . . . . . . . . . . . . . . . . . . .>     from_unixtime(FLOOR(CAST(report_datetime AS BIGINT)/1000), 'yyyy-MM-dd HH:mm:ss.SSS') AS report_datetime,
. . . . . . . . . . . . . . . . . . . . . . .>     row_id,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_id,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_number,
. . . . . . . . . . . . . . . . . . . . . . .>     cad_number,
. . . . . . . . . . . . . . . . . . . . . . .>     report_type_code,
. . . . . . . . . . . . . . . . . . . . . . .>     report_type_description,
. . . . . . . . . . . . . . . . . . . . . . .>     filled_online,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_code,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_category,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_subcategory,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_descr,
. . . . . . . . . . . . . . . . . . . . . . .>     resolution,
. . . . . . . . . . . . . . . . . . . . . . .>     intersection,
. . . . . . . . . . . . . . . . . . . . . . .>     cnn,
. . . . . . . . . . . . . . . . . . . . . . .>     police_district,
. . . . . . . . . . . . . . . . . . . . . . .>     analysis_neigh,
. . . . . . . . . . . . . . . . . . . . . . .>     supervisor_distr,
. . . . . . . . . . . . . . . . . . . . . . .>     supervisor_distr_2012,
. . . . . . . . . . . . . . . . . . . . . . .>     latitude,
. . . . . . . . . . . . . . . . . . . . . . .>     longitude,
. . . . . . . . . . . . . . . . . . . . . . .>     datapoint,
. . . . . . . . . . . . . . . . . . . . . . .>     neighbourhoods,
. . . . . . . . . . . . . . . . . . . . . . .>     esncag,
. . . . . . . . . . . . . . . . . . . . . . .>     cm_polygon,
. . . . . . . . . . . . . . . . . . . . . . .>     cchr,
. . . . . . . . . . . . . . . . . . . . . . .>     hsoc,
. . . . . . . . . . . . . . . . . . . . . . .>     iin,
. . . . . . . . . . . . . . . . . . . . . . .>     csd,
. . . . . . . . . . . . . . . . . . . . . . .>     cpd,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_year
. . . . . . . . . . . . . . . . . . . . . . .> FROM police_dept_incident_reports;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS police_dept_incident_reports;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 