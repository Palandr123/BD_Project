0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.resultset.use.unique.column.names = false;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team1_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS q1_results;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Group incidents by year
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE q1_results
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .>     incident_year INT,
. . . . . . . . . . . . . . . . . . . . . . .>     incident_count INT
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .>     ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .>     FIELDS TERMINATED BY ','
. . . . . . . . . . . . . . . . . . . . . . .>     location 'project/hive/warehouse/q1'; 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO q1_results
. . . . . . . . . . . . . . . . . . . . . . .> SELECT incident_year,
. . . . . . . . . . . . . . . . . . . . . . .> COUNT(*) AS incident_count
. . . . . . . . . . . . . . . . . . . . . . .> FROM police_dept_incident_reports_part_buck AS incidents
. . . . . . . . . . . . . . . . . . . . . . .> GROUP BY incident_year
. . . . . . . . . . . . . . . . . . . . . . .> ORDER BY incident_count DESC;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM q1_results;
+----------------+-----------------+
| incident_year  | incident_count  |
+----------------+-----------------+
| 4              | 13479           |
| 6              | 13209           |
| 3              | 11599           |
| 1              | 10916           |
| 5              | 10478           |
| 2              | 8779            |
| 9              | 8052            |
| 10             | 7786            |
| NULL           | 6435            |
| 8              | 5351            |
| 7              | 3916            |
+----------------+-----------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 